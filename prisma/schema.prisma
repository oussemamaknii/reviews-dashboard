// Prisma schema for reviews dashboard
// Dev: SQLite. For Vercel, switch provider to postgresql and set DATABASE_URL

generator client {
  provider = "prisma-client-js"
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model Property {
  id            String   @id
  name          String   @unique
  location      String
  imageUrl      String
  pricePerNight Int
  maxGuests     Int
  createdAt     DateTime @default(now())
  updatedAt     DateTime @updatedAt
  reviews       Review[]
}

enum ReviewStatus {
  pending
  approved
  rejected
}

model Review {
  id          String        @id
  propertyId  String
  property    Property      @relation(fields: [propertyId], references: [id], onDelete: Cascade)
  channel     String        @default("hostaway")
  guestName   String
  rating      Float
  reviewText  String
  submittedAt DateTime
  status      ReviewStatus  @default(pending)
  isPublic    Boolean       @default(false)
  createdAt   DateTime      @default(now())
  updatedAt   DateTime      @updatedAt
  categories  ReviewCategory[]
}

model ReviewCategory {
  id       String @id
  reviewId String
  review   Review @relation(fields: [reviewId], references: [id], onDelete: Cascade)
  category String
  rating   Float
}
